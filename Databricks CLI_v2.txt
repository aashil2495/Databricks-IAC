Login to Azure Portal.
az login

Create Resource Group named myResourceGroup, you can replace it with your own name.
az group create --name myResourceGroup --location southcentralus

Create a premium Databricks workspace named "myDatabricksWorkspace" in "myResourceGroup" resource group at location "southcentralus".
az databricks workspace create --resource-group myResourceGroup --name myDatabricksWorkspace --location southcentralus --sku premium

Create Storage account named "itmmystorageaccountgen2"
az storage account create --name itmmystorageaccountgen2 --resource-group myResourceGroup --location southcentralus --sku Standard_LRS --kind StorageV2 --hns true

Create Container named "itmmystorageaccountcli" in storage account
az storage container create --account-name itmmystorageaccountcli --name container

List the containers in storage account.
az storage container list --account-name itmmystorageaccountcli --auth-mode login --query "[].name" -o table

Configure the Databricks PAT Token
databricks configure --token

Create unity catalog metastore in Databricks account
databricks unity-catalog metastores create --name metastoresouthcentralus --storage-root abfss://container@itmmystorageaccountcli.dfs.core.windows.net/ --region southcentralus

Assign metastore to workspace
databricks unity-catalog metastores assign --workspace-id 2802728894264871 --metastore-id a6c116d8-6ec1-460a-98d1-6f0f62e25695 --default-catalog-name main

Create Databricks access connector
az databricks access-connector create --resource-group myResourceGroup --name my-access-connector --location southcentralus --identity-type SystemAssigned

List Datarbicks Access connector
az databricks access-connector show --resource-group myResourceGroup --name my-access-connector --query "identity.principalId" -o tsv

List Azure subscriptions
az account list --output table

List storage accounts
az storage account list --output table

Assign Role to Managed Identity(Access Connector)
az role assignment create --assignee ea0bb2f9-762f-496c-a5ce-8d33f4dd1790 --role "Storage Blob Data Contributor" --scope "/subscriptions/d066615d-e286-4bf1-92e7-7df087f1f4d0/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/itmmystorageaccountcli"

List access connectors
az databricks access-connector list --output json

Create storage credentails named "external-loc"
databricks unity-catalog storage-credentials create --name external-loc --az-mi-access-connector-id "/subscriptions/d066615d-e286-4bf1-92e7-7df087f1f4d0/resourceGroups/myResourceGroup/providers/Microsoft.Databricks/accessConnectors/my-access-connector"

Create External Location named "my_external_location" with storage credentails named "external-loc"
databricks unity-catalog external-locations create --name my_external_location --url abfss://container@itmmystorageaccountcli.dfs.core.windows.net/ --storage-credential-name external-loc


